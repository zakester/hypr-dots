function _regeneratorRuntime(){"use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime=function t(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(c){u=function e(t,n,r){return t[n]=r}}function l(e,t,n,a){var o,i,s,u,c=Object.create((t&&t.prototype instanceof d?t:d).prototype);return r(c,"_invoke",{value:(o=e,i=n,s=new C(a||[]),u="suspendedStart",function(e,t){if("executing"===u)throw Error("Generator is already running");if("completed"===u){if("throw"===e)throw t;return A()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){var r=k(n,s);if(r){if(r===h)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===u)throw u="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);u="executing";var a=f(o,i,s);if("normal"===a.type){if(u=s.done?"completed":"suspendedYield",a.arg===h)continue;return{value:a.arg,done:s.done}}"throw"===a.type&&(u="completed",s.method="throw",s.arg=a.arg)}})}),c}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}e.wrap=l;var h={};function d(){}function p(){}function v(){}var g={};u(g,o,function(){return this});var y=Object.getPrototypeOf,$=y&&y(y(T([])));$&&$!==t&&n.call($,o)&&(g=$);var m=v.prototype=d.prototype=Object.create(g);function _(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function b(e,t){var a;r(this,"_invoke",{value:function r(o,i){function s(){return new t(function(r,a){!function r(a,o,i,s){var u=f(e[a],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,i,s)},function(e){r("throw",e,i,s)}):t.resolve(l).then(function(e){c.value=e,i(c)},function(e){return r("throw",e,i,s)})}s(u.arg)}(o,i,r,a)})}return a=a?a.then(s,s):s()}})}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=TypeError("The iterator does not provide a '"+n+"' method")),h;var a=f(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=TypeError("iterator result is not an object"),t.delegate=null,h)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:A}}function A(){return{value:void 0,done:!0}}return p.prototype=v,r(m,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:p,configurable:!0}),p.displayName=u(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},_(b.prototype),u(b.prototype,i,function(){return this}),e.AsyncIterator=b,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new b(l(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},_(m),u(m,s,"Generator"),u(m,o,function(){return this}),u(m,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=T,C.prototype={constructor:C,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var r=this;function a(e,n){return s.type="throw",s.arg=t,r.next=e,n&&(r.method="next",r.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function e(t,r){for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=r,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(s)},complete:function e(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),h},finish:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),h}},catch:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var o=a.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function e(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}function asyncGeneratorStep(e,t,n,r,a,o,i){try{var s=e[o](i),u=s.value}catch(c){n(c);return}s.done?t(u):Promise.resolve(u).then(r,a)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){asyncGeneratorStep(o,r,a,i,s,"next",e)}function s(e){asyncGeneratorStep(o,r,a,i,s,"throw",e)}i(void 0)})}}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(l){c=!0,a=l}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(e,t)}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==_typeof(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}this.zxcvbnts=this.zxcvbnts||{},this.zxcvbnts.core=function(e){"use strict";var t,n=function e(t,n){return t.push.apply(t,n)},r=function e(t,n){return t.split("").map(function(e){return n[e]||e}).join("")},a=function e(t){return t.sort(function(e,t){return e.i-t.i||e.j-t.j})},o=function e(t){var n={},r=1;return t.forEach(function(e){n[e]=r,r+=1}),n},i={4:[[1,2],[2,3]],5:[[1,3],[2,3]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]},s=/^[A-Z\xbf-\xdf][^A-Z\xbf-\xdf]+$/,u=/^[^A-Z\xbf-\xdf]+[A-Z\xbf-\xdf]$/,c=/^[A-Z\xbf-\xdf]+$/,l=/^[^a-z\xdf-\xff]+$/,f=/^[a-z\xdf-\xff]+$/,h=/^[^A-Z\xbf-\xdf]+$/,d=/[a-z\xdf-\xff]/,p=/[A-Z\xbf-\xdf]/,v=/[^A-Za-z\xbf-\xdf]/gi,g=/^\d+$/,y=new Date().getFullYear(),$={recentYear:/19\d\d|200\d|201\d|202\d/g},m=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"match",value:function e(t){var n=t.password,r=[].concat(_toConsumableArray(this.getMatchesWithoutSeparator(n)),_toConsumableArray(this.getMatchesWithSeparator(n))),o=this.filterNoise(r);return a(o)}},{key:"getMatchesWithSeparator",value:function e(t){for(var n=[],r=/^(\d{1,4})([\s/\\_.-])(\d{1,2})\2(\d{1,4})$/,a=0;a<=Math.abs(t.length-6);a+=1)for(var o=a+5;o<=a+9&&!(o>=t.length);o+=1){var i=t.slice(a,+o+1||9e9),s=r.exec(i);if(null!=s){var u=this.mapIntegersToDayMonthYear([parseInt(s[1],10),parseInt(s[3],10),parseInt(s[4],10)]);null!=u&&n.push({pattern:"date",token:i,i:a,j:o,separator:s[2],year:u.year,month:u.month,day:u.day})}}return n}},{key:"getMatchesWithoutSeparator",value:function e(t){for(var n=this,r=[],a=/^\d{4,8}$/,o=function e(t){return Math.abs(t.year-y)},s=0;s<=Math.abs(t.length-4);s+=1)for(var u=function e(){if(c>=t.length)return"break";var u=t.slice(s,+c+1||9e9);if(a.exec(u)){var l=[];if(i[u.length].forEach(function(e){var t=_slicedToArray(e,2),r=t[0],a=t[1],o=n.mapIntegersToDayMonthYear([parseInt(u.slice(0,r),10),parseInt(u.slice(r,a),10),parseInt(u.slice(a),10)]);null!=o&&l.push(o)}),l.length>0){var f=l[0],h=o(l[0]);l.slice(1).forEach(function(e){var t=o(e);t<h&&(f=e,h=t)}),r.push({pattern:"date",token:u,i:s,j:c,separator:"",year:f.year,month:f.month,day:f.day})}}},c=s+3;c<=s+7&&"break"!==u();c+=1);return r}},{key:"filterNoise",value:function e(t){return t.filter(function(e){for(var n=!1,r=t.length,a=0;a<r;a+=1){var o=t[a];if(e!==o&&o.i<=e.i&&o.j>=e.j){n=!0;break}}return!n})}},{key:"mapIntegersToDayMonthYear",value:function e(t){if(t[1]>31||t[1]<=0)return null;for(var n=0,r=0,a=0,o=0,i=t.length;o<i;o+=1){var s=t[o];if(s>99&&s<1e3||s>2050)return null;s>31&&(r+=1),s>12&&(n+=1),s<=0&&(a+=1)}return r>=2||3===n||a>=2?null:this.getDayMonth(t)}},{key:"getDayMonth",value:function e(t){for(var n=[[t[2],t.slice(0,2)],[t[0],t.slice(1,3)]],r=n.length,a=0;a<r;a+=1){var o=_slicedToArray(n[a],2),i=o[0],s=o[1];if(1e3<=i&&i<=2050){var u=this.mapIntegersToDayMonth(s);if(null!=u)return{year:i,month:u.month,day:u.day};return null}}for(var c=0;c<r;c+=1){var l=_slicedToArray(n[c],2),f=l[0],h=l[1],d=this.mapIntegersToDayMonth(h);if(null!=d)return{year:this.twoToFourDigitYear(f),month:d.month,day:d.day}}return null}},{key:"mapIntegersToDayMonth",value:function e(t){for(var n=[t,t.slice().reverse()],r=0;r<n.length;r+=1){var a=n[r],o=a[0],i=a[1];if(o>=1&&o<=31&&i>=1&&i<=12)return{day:o,month:i}}return null}},{key:"twoToFourDigitYear",value:function e(t){return t>99?t:t>50?t+1900:t+2e3}}]),e}(),_=new Uint32Array(65536),b=function e(t,n){for(var r=t.length,a=n.length,o=1<<r-1,i=-1,s=0,u=r,c=r;c--;)_[t.charCodeAt(c)]|=1<<c;for(c=0;c<a;c++){var l=_[n.charCodeAt(c)],f=l|s;l|=(l&i)+i^i,s|=~(l|i),i&=l,s&o&&u++,i&o&&u--,i=i<<1|~(f|(s=s<<1|1)),s&=f}for(c=r;c--;)_[t.charCodeAt(c)]=0;return u},k=function e(t,n){for(var r=t.length,a=n.length,o=[],i=[],s=Math.ceil(r/32),u=Math.ceil(a/32),c=a,l=0;l<s;l++)i[l]=-1,o[l]=0;for(var f=0;f<u-1;f++){for(var h=0,d=-1,p=32*f,v=Math.min(32,a)+p,g=p;g<v;g++)_[n.charCodeAt(g)]|=1<<g;c=a;for(var y=0;y<r;y++){var $=_[t.charCodeAt(y)],m=i[y/32|0]>>>y&1,b=o[y/32|0]>>>y&1,k=$|h,w=(($|b)&d)+d^d|$|b,x=h|~(w|d),C=d&w;x>>>31^m&&(i[y/32|0]^=1<<y),C>>>31^b&&(o[y/32|0]^=1<<y),x=x<<1|m,d=(C=C<<1|b)|~(k|x),h=x&k}for(var T=p;T<v;T++)_[n.charCodeAt(T)]=0}for(var A=0,S=-1,L=32*f,E=Math.min(32,a-L)+L,j=L;j<E;j++)_[n.charCodeAt(j)]|=1<<j;c=a;for(var I=0;I<r;I++){var M=_[t.charCodeAt(I)],P=i[I/32|0]>>>I&1,D=o[I/32|0]>>>I&1,G=M|A,N=((M|D)&S)+S^S|M|D,z=A|~(N|S),q=S&N;c+=z>>>a-1&1,c-=q>>>a-1&1,z>>>31^P&&(i[I/32|0]^=1<<I),q>>>31^D&&(o[I/32|0]^=1<<I),z=z<<1|P,S=(q=q<<1|D)|~(G|z),A=z&G}for(var R=L;R<E;R++)_[n.charCodeAt(R)]=0;return c},w=function e(t,n){if(t.length>n.length){var r=n;n=t,t=r}return 0===t.length?n.length:t.length<=32?b(t,n):k(t,n)},x={closest:function e(t,n){for(var r=1/0,a=0,o=0;o<n.length;o++){var i=w(t,n[o]);i<r&&(r=i,a=o)}return n[a]},distance:w},C=function e(t,n,r){var a=t.length<=n.length,o=t.length<=r;return a||o?Math.ceil(t.length/4):r},T=function e(t,n,r){var a=0,o=Object.keys(n).find(function(e){var n=C(t,e,r);if(Math.abs(t.length-e.length)>n)return!1;var o=x.distance(t,e),i=o<=n;return i&&(a=o),i});return o?{levenshteinDistance:a,levenshteinDistanceEntry:o}:{}},A={a:["4","@"],b:["8"],c:["(","{","[","<"],e:["3"],g:["6","9"],i:["1","!","|"],l:["1","|","7"],o:["0"],s:["$","5"],t:["+","7"],x:["%"],z:["2"]},S={warnings:{straightRow:"straightRow",keyPattern:"keyPattern",simpleRepeat:"simpleRepeat",extendedRepeat:"extendedRepeat",sequences:"sequences",recentYears:"recentYears",dates:"dates",topTen:"topTen",topHundred:"topHundred",common:"common",similarToCommon:"similarToCommon",wordByItself:"wordByItself",namesByThemselves:"namesByThemselves",commonNames:"commonNames",userInputs:"userInputs",pwned:"pwned"},suggestions:{l33t:"l33t",reverseWords:"reverseWords",allUppercase:"allUppercase",capitalization:"capitalization",dates:"dates",recentYears:"recentYears",associatedYears:"associatedYears",sequences:"sequences",repeated:"repeated",longerKeyboardPattern:"longerKeyboardPattern",anotherWord:"anotherWord",useWords:"useWords",noNeed:"noNeed",pwned:"pwned"},timeEstimation:{ltSecond:"ltSecond",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",month:"month",months:"months",year:"year",years:"years",centuries:"centuries"}},L=new(function(){function e(){_classCallCheck(this,e),this.matchers={},this.l33tTable=A,this.dictionary={userInputs:[]},this.rankedDictionaries={},this.translations=S,this.graphs={},this.availableGraphs=[],this.useLevenshteinDistance=!1,this.levenshteinThreshold=2,this.setRankedDictionaries()}return _createClass(e,[{key:"setOptions",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.l33tTable&&(this.l33tTable=t.l33tTable),t.dictionary&&(this.dictionary=t.dictionary,this.setRankedDictionaries()),t.translations&&this.setTranslations(t.translations),t.graphs&&(this.graphs=t.graphs),void 0!==t.useLevenshteinDistance&&(this.useLevenshteinDistance=t.useLevenshteinDistance),void 0!==t.levenshteinThreshold&&(this.levenshteinThreshold=t.levenshteinThreshold)}},{key:"setTranslations",value:function e(t){if(this.checkCustomTranslations(t))this.translations=t;else throw Error("Invalid translations object fallback to keys")}},{key:"checkCustomTranslations",value:function e(t){var n=!0;return Object.keys(S).forEach(function(e){if(e in t){var r=e;Object.keys(S[r]).forEach(function(e){e in t[r]||(n=!1)})}else n=!1}),n}},{key:"setRankedDictionaries",value:function e(){var t=this,n={};Object.keys(this.dictionary).forEach(function(e){n[e]=t.getRankedDictionary(e)}),this.rankedDictionaries=n}},{key:"getRankedDictionary",value:function e(t){var n=this.dictionary[t];if("userInputs"===t){var r=[];return n.forEach(function(e){var t=_typeof(e);("string"===t||"number"===t||"boolean"===t)&&r.push(e.toString().toLowerCase())}),o(r)}return o(n)}},{key:"extendUserInputsDictionary",value:function e(t){this.dictionary.userInputs?this.dictionary.userInputs=[].concat(_toConsumableArray(this.dictionary.userInputs),_toConsumableArray(t)):this.dictionary.userInputs=t,this.rankedDictionaries.userInputs=this.getRankedDictionary("userInputs")}},{key:"addMatcher",value:function e(t,n){this.matchers[t]?console.info("Matcher already exists"):this.matchers[t]=n}}]),e}()),E=function(){function e(t){_classCallCheck(this,e),this.defaultMatch=t}return _createClass(e,[{key:"match",value:function e(t){var n=t.password,r=n.split("").reverse().join("");return this.defaultMatch({password:r}).map(function(e){return _objectSpread(_objectSpread({},e),{},{token:e.token.split("").reverse().join(""),reversed:!0,i:n.length-1-e.j,j:n.length-1-e.i})})}}]),e}(),j=function(){function e(t){_classCallCheck(this,e),this.defaultMatch=t}return _createClass(e,[{key:"match",value:function e(t){for(var n=this,a=t.password,o=[],i=this.enumerateL33tSubs(this.relevantL33tSubtable(a,L.l33tTable)),s=0;s<i.length&&"break"!==function e(){var t,u=i[s];if(0===Object.keys(t=u).length)return"break";var c=r(a,u);n.defaultMatch({password:c}).forEach(function(e){var t=a.slice(e.i,+e.j+1||9e9);if(t.toLowerCase()!==e.matchedWord){var n={};Object.keys(u).forEach(function(e){var r=u[e];-1!==t.indexOf(e)&&(n[e]=r)});var r=Object.keys(n).map(function(e){return"".concat(e," -> ").concat(n[e])}).join(", ");o.push(_objectSpread(_objectSpread({},e),{},{l33t:!0,token:t,sub:n,subDisplay:r}))}})}();s+=1);return o.filter(function(e){return e.token.length>1})}},{key:"relevantL33tSubtable",value:function e(t,n){var r={},a={};return t.split("").forEach(function(e){r[e]=!0}),Object.keys(n).forEach(function(e){var t=n[e].filter(function(e){return e in r});t.length>0&&(a[e]=t)}),a}},{key:"enumerateL33tSubs",value:function e(t){var n=Object.keys(t);return this.getSubs(n,[[]],t).map(function(e){var t={};return e.forEach(function(e){var n=_slicedToArray(e,2),r=n[0],a=n[1];t[r]=a}),t})}},{key:"getSubs",value:function e(t,n,r){if(!t.length)return n;var a=t[0],o=t.slice(1),i=[];r[a].forEach(function(e){n.forEach(function(t){for(var n=-1,r=0;r<t.length;r+=1)if(t[r][0]===e){n=r;break}if(-1===n){var o=t.concat([[e,a]]);i.push(o)}else{var s=t.slice(0);s.splice(n,1),s.push([e,a]),i.push(t),i.push(s)}})});var s=this.dedup(i);return o.length?this.getSubs(o,s,r):s}},{key:"dedup",value:function e(t){var n=[],r={};return t.forEach(function(e){var t=e.map(function(e,t){return[e,t]});t.sort();var a=t.map(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return"".concat(n,",").concat(r)}).join("-");a in r||(r[a]=!0,n.push(e))}),n}}]),e}(),I=function(){function e(){_classCallCheck(this,e),this.l33t=new j(this.defaultMatch),this.reverse=new E(this.defaultMatch)}return _createClass(e,[{key:"match",value:function e(t){var n=t.password,r=[].concat(_toConsumableArray(this.defaultMatch({password:n})),_toConsumableArray(this.reverse.match({password:n})),_toConsumableArray(this.l33t.match({password:n})));return a(r)}},{key:"defaultMatch",value:function e(t){var n=t.password,r=[],a=n.length,o=n.toLowerCase();return Object.keys(L.rankedDictionaries).forEach(function(e){for(var t=L.rankedDictionaries[e],i=0;i<a;i+=1)for(var s=i;s<a;s+=1){var u=o.slice(i,+s+1||9e9),c=u in t,l={},f=0===i&&s===a-1;L.useLevenshteinDistance&&f&&!c&&(l=T(u,t,L.levenshteinThreshold));var h=0!==Object.keys(l).length;if(c||h){var d=t[h?l.levenshteinDistanceEntry:u];r.push(_objectSpread({pattern:"dictionary",i:i,j:s,token:n.slice(i,+s+1||9e9),matchedWord:u,rank:d,dictionaryName:e,reversed:!1,l33t:!1},l))}}}),r}}]),e}(),M=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"match",value:function e(t){var n=t.password,r=t.regexes,o=void 0===r?$:r,i=[];return Object.keys(o).forEach(function(e){var t=o[e];t.lastIndex=0;var r=t.exec(n);if(r){var a=r[0];i.push({pattern:"regex",token:a,i:r.index,j:r.index+r[0].length-1,regexName:e,regexMatch:r})}}),a(i)}}]),e}(),P={nCk:function e(t,n){var r=t;if(n>r)return 0;if(0===n)return 1;for(var a=1,o=1;o<=n;o+=1)a*=r,a/=o,r-=1;return a},log10:function e(t){return Math.log(t)/Math.log(10)},log2:function e(t){return Math.log(t)/Math.log(2)},factorial:function e(t){for(var n=1,r=2;r<=t;r+=1)n*=r;return n}},D=function e(t){for(var n=t.split(""),r=n.filter(function(e){return e.match(d)}).length,a=n.filter(function(e){return e.match(p)}).length,o=0,i=Math.min(r,a),s=1;s<=i;s+=1)o+=P.nCk(r+a,s);return o},G=function e(t){var n=t.replace(v,"");if(n.match(h)||n.toLowerCase()===n)return 1;for(var r=[s,u,l],a=r.length,o=0;o<a;o+=1){var i=r[o];if(n.match(i))return 2}return D(n)},N=function e(t){var n,r=t.subs,a=t.subbed,o=t.token,i=r[a],s=o.toLowerCase().split("");return{subbedCount:s.filter(function(e){return e===a}).length,unsubbedCount:s.filter(function(e){return e===i}).length}},z=function e(t){var n=t.l33t,r=t.sub,a=t.token;if(!n)return 1;var o=1,i=r;return Object.keys(i).forEach(function(e){var t=N({subs:i,subbed:e,token:a}),n=t.subbedCount,r=t.unsubbedCount;if(0===n||0===r)o*=2;else{for(var s=Math.min(r,n),u=0,c=1;c<=s;c+=1)u+=P.nCk(r+n,c);o*=u}}),o},q=function e(t){var n=0;return Object.keys(t).forEach(function(e){n+=t[e].filter(function(e){return!!e}).length}),n/=Object.entries(t).length},R=function e(t){for(var n=t.token,r=t.graph,a=t.turns,o=Object.keys(L.graphs[r]).length,i=q(L.graphs[r]),s=0,u=n.length,c=2;c<=u;c+=1)for(var l=Math.min(a,c-1),f=1;f<=l;f+=1)s+=P.nCk(c-1,f-1)*o*Math.pow(i,f);return s},Y=function e(t,n){var r=1;return t.token.length<n.length&&(r=1===t.token.length?10:50),r},F={bruteforce:function e(t){var n,r=t.token,a=Math.pow(10,r.length);return a===Number.POSITIVE_INFINITY&&(a=Number.MAX_VALUE),Math.max(a,n=1===r.length?11:51)},date:function e(t){var n=t.year,r=t.separator,a=365*Math.max(Math.abs(n-y),20);return r&&(a*=4),a},dictionary:function e(t){var n=t.rank,r=t.reversed,a=t.l33t,o=t.sub,i=t.token,s=n,u=G(i),c=z({l33t:a,sub:o,token:i});return{baseGuesses:s,uppercaseVariations:u,l33tVariations:c,calculation:s*u*c*(r&&2||1)}},regex:function e(t){var n=t.regexName,r=t.regexMatch,a=t.token,o={alphaLower:26,alphaUpper:26,alpha:52,alphanumeric:62,digits:10,symbols:33};return n in o?Math.pow(o[n],a.length):"recentYear"===n?Math.max(Math.abs(parseInt(r[0],10)-y),20):0},repeat:function e(t){var n;return t.baseGuesses*t.repeatCount},sequence:function e(t){var n=t.token,r=t.ascending,a=n.charAt(0),o=0;return o=["a","A","z","Z","0","1","9"].includes(a)?4:a.match(/\d/)?10:26,r||(o*=2),o*n.length},spatial:function e(t){var n=t.graph,r=t.token,a=t.shiftedCount,o=R({token:r,graph:n,turns:t.turns});if(a){var i=r.length-a;if(0===a||0===i)o*=2;else{for(var s=0,u=1;u<=Math.min(a,i);u+=1)s+=P.nCk(a+i,u);o*=s}}return Math.round(o)}},W=function e(t,n){var r={};if("guesses"in t&&null!=t.guesses)return t;var a,o,i=Y(t,n),s=(a=t.pattern,o=t,F[a]?F[a](o):L.matchers[a]&&"scoring"in L.matchers[a]?L.matchers[a].scoring(o):0),u=0;"number"==typeof s?u=s:"dictionary"===t.pattern&&(u=s.calculation,r.baseGuesses=s.baseGuesses,r.uppercaseVariations=s.uppercaseVariations,r.l33tVariations=s.l33tVariations);var c=Math.max(u,i);return _objectSpread(_objectSpread(_objectSpread({},t),r),{},{guesses:c,guessesLog10:P.log10(c)})},H={password:"",optimal:{},excludeAdditive:!1,fillArray:function e(t,n){for(var r=[],a=0;a<t;a+=1){var o=[];"object"===n&&(o={}),r.push(o)}return r},makeBruteforceMatch:function e(t,n){return{pattern:"bruteforce",token:this.password.slice(t,+n+1||9e9),i:t,j:n}},update:function e(t,n){var r=this,a=t.j,o=W(t,this.password),i=o.guesses;n>1&&(i*=this.optimal.pi[o.i-1][n-1]);var s=P.factorial(n)*i;this.excludeAdditive||(s+=Math.pow(1e4,n-1));var u=!1;Object.keys(this.optimal.g[a]).forEach(function(e){var t=r.optimal.g[a][e];parseInt(e,10)<=n&&t<=s&&(u=!0)}),u||(this.optimal.g[a][n]=s,this.optimal.m[a][n]=o,this.optimal.pi[a][n]=i)},bruteforceUpdate:function e(t){var n=this,r=this.makeBruteforceMatch(0,t);this.update(r,1);for(var a=function e(){r=n.makeBruteforceMatch(o,t);var a=n.optimal.m[o-1];Object.keys(a).forEach(function(e){"bruteforce"!==a[e].pattern&&n.update(r,parseInt(e,10)+1)})},o=1;o<=t;o+=1)a()},unwind:function e(t){var n=[],r=t-1,a=0,o=Infinity,i=this.optimal.g[r];for(i&&Object.keys(i).forEach(function(e){var t=i[e];t<o&&(a=parseInt(e,10),o=t)});r>=0;){var s=this.optimal.m[r][a];n.unshift(s),r=s.i-1,a-=1}return n}},O={mostGuessableMatchSequence:function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];H.password=t,H.excludeAdditive=r;var a=t.length,o=H.fillArray(a,"array");n.forEach(function(e){o[e.j].push(e)}),o=o.map(function(e){return e.sort(function(e,t){return e.i-t.i})}),H.optimal={m:H.fillArray(a,"object"),pi:H.fillArray(a,"object"),g:H.fillArray(a,"object")};for(var i=0;i<a;i+=1)o[i].forEach(function(e){e.i>0?Object.keys(H.optimal.m[e.i-1]).forEach(function(t){H.update(e,parseInt(t,10)+1)}):H.update(e,1)}),H.bruteforceUpdate(i);var s=H.unwind(a),u=s.length,c=this.getGuesses(t,u);return{password:t,guesses:c,guessesLog10:P.log10(c),sequence:s}},getGuesses:function e(t,n){var r=t.length,a=0;return 0===t.length?1:H.optimal.g[r-1][n]}},U=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"match",value:function e(t){for(var n=t.password,r=t.omniMatch,a=[],o=0;o<n.length;){var i=this.getGreedyMatch(n,o),s=this.getLazyMatch(n,o);if(null==i)break;var u=this.setMatchToken(i,s),e=u.match,c=u.baseToken;if(e){var l=e.index+e[0].length-1,f=this.getBaseGuesses(c,r);a.push(this.normalizeMatch(c,l,e,f)),o=l+1}}return a.some(function(e){return e instanceof Promise})?Promise.all(a):a}},{key:"normalizeMatch",value:function e(t,n,r,a){var o={pattern:"repeat",i:r.index,j:n,token:r[0],baseToken:t,baseGuesses:0,repeatCount:r[0].length/t.length};return a instanceof Promise?a.then(function(e){return _objectSpread(_objectSpread({},o),{},{baseGuesses:e})}):_objectSpread(_objectSpread({},o),{},{baseGuesses:a})}},{key:"getGreedyMatch",value:function e(t,n){var r=/(.+)\1+/g;return r.lastIndex=n,r.exec(t)}},{key:"getLazyMatch",value:function e(t,n){var r=/(.+?)\1+/g;return r.lastIndex=n,r.exec(t)}},{key:"setMatchToken",value:function e(t,n){var r,a="";if(n&&t[0].length>n[0].length){r=t;var o=/^(.+?)\1+$/.exec(r[0]);o&&(a=o[1])}else(r=n)&&(a=r[1]);return{match:r,baseToken:a}}},{key:"getBaseGuesses",value:function e(t,n){var r=n.match(t);return r instanceof Promise?r.then(function(e){return O.mostGuessableMatchSequence(t,e).guesses}):(0,O.mostGuessableMatchSequence(t,r).guesses)}}]),e}(),B=function(){function e(){_classCallCheck(this,e),this.MAX_DELTA=5}return _createClass(e,[{key:"match",value:function e(t){var n=t.password,r=[];if(1===n.length)return[];for(var a=0,o=null,i=n.length,s=1;s<i;s+=1){var u=n.charCodeAt(s)-n.charCodeAt(s-1);if(null==o&&(o=u),u!==o){var c=s-1;this.update({i:a,j:c,delta:o,password:n,result:r}),a=c,o=u}}return this.update({i:a,j:i-1,delta:o,password:n,result:r}),r}},{key:"update",value:function e(t){var n=t.i,r=t.j,a=t.delta,o=t.password,i=t.result;if(r-n>1||1===Math.abs(a)){var s=Math.abs(a);if(s>0&&s<=this.MAX_DELTA){var u=o.slice(n,+r+1||9e9),c=this.getSequence(u),l=c.sequenceName,f=c.sequenceSpace;return i.push({pattern:"sequence",i:n,j:r,token:o.slice(n,+r+1||9e9),sequenceName:l,sequenceSpace:f,ascending:a>0})}}return null}},{key:"getSequence",value:function e(t){var n="unicode",r=26;return f.test(t)?(n="lower",r=26):c.test(t)?(n="upper",r=26):g.test(t)&&(n="digits",r=10),{sequenceName:n,sequenceSpace:r}}}]),e}(),K=function(){function e(){_classCallCheck(this,e),this.SHIFTED_RX=/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/}return _createClass(e,[{key:"match",value:function e(t){var r=this,o=t.password,i=[];return Object.keys(L.graphs).forEach(function(e){var t=L.graphs[e];n(i,r.helper(o,t,e))}),a(i)}},{key:"checkIfShifted",value:function e(t,n,r){return!t.includes("keypad")&&this.SHIFTED_RX.test(n.charAt(r))?1:0}},{key:"helper",value:function e(t,n,r){for(var a,o=[],i=0,s=t.length;i<s-1;){var u=i+1,c=0,l=0;for(a=this.checkIfShifted(r,t,i);;){var f=n[t.charAt(u-1)]||[],h=!1,d=-1,p=-1;if(u<s)for(var v=t.charAt(u),g=f.length,y=0;y<g;y+=1){var $=f[y];if(p+=1,$){var m=$.indexOf(v);if(-1!==m){h=!0,1===m&&(a+=1),c!==(d=p)&&(l+=1,c=d);break}}}if(h)u+=1;else{u-i>2&&o.push({pattern:"spatial",i:i,j:u-1,token:t.slice(i,u),graph:r,turns:l,shiftedCount:a}),i=u;break}}}return o}}]),e}(),Z=function(){function e(){_classCallCheck(this,e),this.matchers={date:m,dictionary:I,regex:M,repeat:U,sequence:B,spatial:K}}return _createClass(e,[{key:"match",value:function e(t){var r=this,o=[],i=[];return([].concat(_toConsumableArray(Object.keys(this.matchers)),_toConsumableArray(Object.keys(L.matchers))).forEach(function(e){if(r.matchers[e]||L.matchers[e]){var a=new(r.matchers[e]?r.matchers[e]:L.matchers[e].Matching)().match({password:t,omniMatch:r});a instanceof Promise?(a.then(function(e){n(o,e)}),i.push(a)):n(o,a)}}),i.length>0)?new Promise(function(e){Promise.all(i).then(function(){e(a(o))})}):a(o)}}]),e}(),V=3600,X=24*V,J=31*X,Q=12*J,ee={second:1,minute:60,hour:V,day:X,month:J,year:Q,century:100*Q},et=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"translate",value:function e(t,n){var r=t;return void 0!==n&&1!==n&&(r+="s"),L.translations.timeEstimation[r].replace("{base}","".concat(n))}},{key:"estimateAttackTimes",value:function e(t){var n=this,r={onlineThrottling100PerHour:t/(100/3600),onlineNoThrottling10PerSecond:t/10,offlineSlowHashing1e4PerSecond:t/1e4,offlineFastHashing1e10PerSecond:t/1e10},a={onlineThrottling100PerHour:"",onlineNoThrottling10PerSecond:"",offlineSlowHashing1e4PerSecond:"",offlineFastHashing1e10PerSecond:""};return Object.keys(r).forEach(function(e){var t=r[e];a[e]=n.displayTime(t)}),{crackTimesSeconds:r,crackTimesDisplay:a,score:this.guessesToScore(t)}}},{key:"guessesToScore",value:function e(t){return t<1005?0:t<1000005?1:t<100000005?2:t<10000000005?3:4}},{key:"displayTime",value:function e(t){var n,r="centuries",a=Object.keys(ee),o=a.findIndex(function(e){return t<ee[e]});return o>-1&&(r=a[o-1],0!==o?n=Math.round(t/ee[r]):r="ltSecond"),this.translate(r,n)}}]),e}(),en=function e(){return null},er=function e(){return{warning:L.translations.warnings.dates,suggestions:[L.translations.suggestions.dates]}},ea=function e(t,n){var r="";return!n||t.l33t||t.reversed?t.guessesLog10<=4&&(r=L.translations.warnings.similarToCommon):r=t.rank<=10?L.translations.warnings.topTen:t.rank<=100?L.translations.warnings.topHundred:L.translations.warnings.common,r},eo=function e(t,n){var r="";return n&&(r=L.translations.warnings.wordByItself),r},ei=function e(t,n){var r,a,o="",i=t.dictionaryName,s="lastnames"===i||i.toLowerCase().includes("firstnames");return"passwords"===i?o=ea(t,n):i.includes("wikipedia")?o=eo(t,n):s?o=(a=n)?L.translations.warnings.namesByThemselves:L.translations.warnings.commonNames:"userInputs"===i&&(o=L.translations.warnings.userInputs),o},es=function e(t,n){var r=ei(t,n),a=[],o=t.token;return o.match(s)?a.push(L.translations.suggestions.capitalization):o.match(l)&&o.toLowerCase()!==o&&a.push(L.translations.suggestions.allUppercase),t.reversed&&t.token.length>=4&&a.push(L.translations.suggestions.reverseWords),t.l33t&&a.push(L.translations.suggestions.l33t),{warning:r,suggestions:a}},eu=function e(t){return"recentYear"===t.regexName?{warning:L.translations.warnings.recentYears,suggestions:[L.translations.suggestions.recentYears,L.translations.suggestions.associatedYears]}:{warning:"",suggestions:[]}},ec=function e(t){var n=L.translations.warnings.extendedRepeat;return 1===t.baseToken.length&&(n=L.translations.warnings.simpleRepeat),{warning:n,suggestions:[L.translations.suggestions.repeated]}},el=function e(){return{warning:L.translations.warnings.sequences,suggestions:[L.translations.suggestions.sequences]}},ef=function e(t){var n=L.translations.warnings.keyPattern;return 1===t.turns&&(n=L.translations.warnings.straightRow),{warning:n,suggestions:[L.translations.suggestions.longerKeyboardPattern]}},eh={warning:"",suggestions:[]},ed=function(){function e(){_classCallCheck(this,e),this.matchers={bruteforce:en,date:er,dictionary:es,regex:eu,repeat:ec,sequence:el,spatial:ef},this.defaultFeedback={warning:"",suggestions:[]},this.setDefaultSuggestions()}return _createClass(e,[{key:"setDefaultSuggestions",value:function e(){this.defaultFeedback.suggestions.push(L.translations.suggestions.useWords,L.translations.suggestions.noNeed)}},{key:"getFeedback",value:function e(t,n){if(0===n.length)return this.defaultFeedback;if(t>2)return eh;var r=L.translations.suggestions.anotherWord,a=this.getLongestMatch(n),o=this.getMatchFeedback(a,1===n.length);return null!=o?(o.suggestions.unshift(r),null==o.warning&&(o.warning="")):o={warning:"",suggestions:[r]},o}},{key:"getLongestMatch",value:function e(t){var n=t[0];return t.slice(1).forEach(function(e){e.token.length>n.token.length&&(n=e)}),n}},{key:"getMatchFeedback",value:function e(t,n){return this.matchers[t.pattern]?this.matchers[t.pattern](t,n):L.matchers[t.pattern]&&"feedback"in L.matchers[t.pattern]?L.matchers[t.pattern].feedback(t,n):eh}}]),e}(),ep=function e(t,n,r){var a;return function e(){for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var u=this,c=function e(){a=void 0,r||t.apply(u,i)},l=r&&!a;if(void 0!==a&&clearTimeout(a),a=setTimeout(c,n),l)return t.apply(u,i)}},ev=function e(){return new Date().getTime()},eg=function e(t,n,r){var a=new ed,o=new et,i=O.mostGuessableMatchSequence(n,t),s=ev()-r,u=o.estimateAttackTimes(i.guesses);return _objectSpread(_objectSpread(_objectSpread({calcTime:s},i),u),{},{feedback:a.getFeedback(u.score,i.sequence)})},ey=function e(t,n){return n&&L.extendUserInputsDictionary(n),new Z().match(t)},e$=function e(t,n){var r=ev(),a=ey(t,n);if(a instanceof Promise)throw Error("You are using a Promised matcher, please use `zxcvbnAsync` for it.");return eg(a,t,r)},em=(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,n){var r,a;return _regeneratorRuntime().wrap(function e(o){for(;;)switch(o.prev=o.next){case 0:return r=ev(),o.next=3,ey(t,n);case 3:return a=o.sent,o.abrupt("return",eg(a,t,r));case 5:case"end":return o.stop()}},e)})),function e(n,r){return t.apply(this,arguments)});return e.debounce=ep,e.zxcvbn=e$,e.zxcvbnAsync=em,e.zxcvbnOptions=L,Object.defineProperty(e,"__esModule",{value:!0}),e}({});